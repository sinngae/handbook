可测试性
----
引用Jerry Gao博士在“Component Testability and Component Testing Challenges”一文中的观点，从可观察、可追踪、可控制、可理解四个方面分析软件测试性设计中应该注意的问题。

（1）可观察：能否容易的观察程序的行为、输入和输出。

任何一项操作或输入都应该有预期的、明确的响应或输出，不管是正确的还是错误的甚至是异常的，这样软件才是可测的；
当前、过去的系统状态和变量应可见或可查询，“可见”是指运行时可见、维护时可见或者调试时可见，“不可见”就“不可发现”，可测试性就低；
所有影响输出的因素可见；
可自动检测、报告内部错误；
错误输出易于识别，无论通过日志自动分析还是界面高亮显示的方式，要能有助于发现；
增加输出参数、减少变量重用，包括打印内部信息、将局部变量作为输出、增加断言、增加局部变量等。
最后一条尤其重要，看见的前提是输出，而且为了容易测试还要多多输出。这里需要给大家介绍一下DRR的概念。

DRR（Domain/Range Ratio），是定义域和值域的比率，也可以理解成输入个数和输出个数的比率。DRR用于度量信息的丢失程度。DRR越大，信息越容易丢失，错误越容易隐藏，测试性也就越低。（输入个数多于输出个数，多个输入只能得到相同的输出，意味着信息丢失）

因此要降低DRR，在输入个数不变的条件下，就要增加输出个数，输出参数越多，能获取的信息越多，也就越容易发现错误。

（2）可控制：能否容易的控制程序的行为、输入和输出。

提供适当的手段，在外界直接或间接的控制系统的状态及变量，例如对于某些全局类型的变量、特殊结构等，可以进行分类并封装到接口中；
采用模块化设计，各模块支持独立测试，对于每个相对独立的模块设计专用的测试驱动和测试桩，模块异常时不影响其他模块的测试（控制测试范围，就能更快地分解、定位问题）；
业务流程和场景易于分解，可以针对单独业务流程进行测试；
提供对外接口，便于构造测试环境模拟外部系统；
提供适当的手段，可以打开或关闭调试输出或打印函数。
测试人员、维护人员能够控制程序的流程、场景、输入和输出，才能有针对性的执行各种用例或实验。通过接口开放流程控制、参数读写功能，也是支持实现自动化测试的基础。

（3）可追踪：能否容易的跟踪程序的操作、状态、性能、错误、GUI事件以及通信情况。

跟踪记录关键函数的持续时间、外部库调用；
跟踪记录关键流程的函数执行过程、输入输出参数；
严格遵从日志规范，正确设置日志级别，输出日志格式标准统一的，便于自动查询和分析；
定义日志类别，区分安全类、业务类、性能类日志，便于问题分析；
约定不同类别、不同级别日志的作用及意义；
日志文件至少保存 15 天，以便对以“周”为频次发生的异常分析。
追踪的目的是可见。日志是一种维护性可见的方式；运行时以及调试时可见，可以通过专门的追踪回显代码或者各种追踪工具软件实现，这儿就不详细说了。

（4）可理解：是否提供了足够的信息，易于获取、易于理解。

遵循行业的标准及规范；
提供用户文档（使用手册等）、工程师文档（设计文档等）、程序资源（软件源代码等）以及质量信息（测试报告等）；
文档、接口、流程、代码、注释、提示信息易于理解。