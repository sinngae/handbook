# 浮点数
> 大部分摘自维基百科及IEEE 754

浮点（Floating point）是一种数值表示方法，由一个有效数字（尾数）加上基数、幂数来表示，通常是尾数乘以基数的幂数次指数。
```math
value = sign * fraction * (base^exponent)
```
这种表示数称为浮点数。
科学技术法以10为基数的特殊浮点；计算机浮点是以2为基数的特殊浮点；整型可以看作基数为1的特殊浮点的特殊表达。

这种表示法是对值的表示范围和精密度之间的取舍。
相同的位数，比如有限的32位二进制为例：
基数为1的浮点，1位正负位，则可表示[-2^30 ～ 2^30]；
基数位2的浮点，如float32，1位正负位，指数8位，有效数23位，可表达[-1*(2^23)*(2^(2^8)) ~ 1*(2^23)*(2^(2^8))]


定点表示法，浮点表示法

## 一、IEEE 754
如果指数是0并且尾数的小数部分是0，这个数±0（和符号位相关）
如果指数 = 2^e-1，并且尾数的小数部分是0，这个数是±∞（同样和符号位相关）
如果指数 = 2^e-1，并且尾数的小数部分非0，这个数表示为非数（NaN）。

在二进制，第一个有效数字必定是“1”，因此这个“1”并不会存储。

单精和双精浮点数的有效数字分别是有存储的23和52个位，加上最左手边没有存储的第1个位，即是24和53个位。
```
log 2^24 =7.22
log 2^53=15.95
```
由以上的计算，单精和双精浮点数可以保证7位和15位十进制有效数字。

C++语言标准定义的浮点数的十进制精度(decimal precision)：十进制数字的位数，可被(浮点数)表示而值不发生变化。
C语言标准定义的浮点数的十进制精度为：十进制数字的位数q，使得任何具有q位十进制数字的浮点数可近似表示为b进制的p位数字并且能近似回十进制表示而不改变这q位十进制数字。

但由于相对近似误差不均匀，有的7位十进制浮点数不能保证近似转化为32比特浮点再近似转化回7位十进制浮点后保持值不变：例如8.589973e9将变成8.589974e9。这种近似误差不会超过1比特的表示能力，因此(24-1)*std::log10(2)等于6.92，下取整为6，成为std::numeric_limits<float>::digits10以及FLT_DIG的值。std::numeric_limits<float>::max_digits10的值为9，含义是必须9位十进制数字才能区分float的所有值；也即float的最大表示区分度。

类似的，std::numeric_limits<double>::digits10或DBL_DIG是15， 
std::numeric_limits<double>::max_digits10是17

### float32 (IEEE 754-2008)
1位正负位，指数8位，有效数23位
### float64
1位正负位，指数11位，有效数52位

## 二、Mysql中的Decimal类型


## 思考
### 1.接口设计是应该使用float32还是float64？还是采用放大倍数的形式？还是无损的字符串的形式？

### 2.重新下单的金额发生变动
浮点数先存到DB，再取出，发生了变化

## 参考附录
1. [维基百科](https://zh.wikipedia.org/wiki/IEEE_754)

2. [IEEE 754](https://web.archive.org/web/20070505021348/http://babbage.cs.qc.edu/courses/cs341/IEEE-754references.html) 