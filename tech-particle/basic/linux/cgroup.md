# cgroup
cgroup，control group，Linux内核功能，用于限制、控制与分离一个进程组的资源（如CPU、内存、磁盘I/O等）。
2006年，google工程师发起进程容器；2007年，linux内核2.6.24版本添加，并命名为cgroup，后续新增了很多功能。

cgroup是为资源管理提供的统一框架，整合cpuset等子系统，从单进程资源控制到操作系统虚拟化的实现。

**概念**
1. 任务（task）。
在cgroup中，任务就是系统的一个进程。
2. 控制族群（control group）。
控制族群就是一组按照某种标准划分的进程。cgroups中的资源控制都是以控制族群为单位实现。
一个进程可以加入到某个控制族群，也从一个进程组迁移到另一个控制族群。
一个进程组的进程可以使用cgroups以控制族群为单位分配的资源，同时受到cgroups以控制族群为单位设定的限制。
3. 层级（hierarchy）。
控制族群可以组织成hierarchical的形式，既一颗控制族群树。
控制族群树上的子节点控制族群是父节点控制族群的孩子，继承父控制族群的特定的属性。
4. 子系统（subsystem）。
一个子系统就是一个资源控制器，比如cpu子系统就是控制cpu时间分配的一个控制器。子系统必须附加（attach）到一个层级上才能起作用，一个子系统附加到某个层级以后，这个层级上的所有控制族群都受到这个子系统的控制。

1. 每次在系统中创建新层级时，该系统中的所有任务都是那个层级的默认 cgroup（我们称之为 root cgroup ，此cgroup在创建层级时自动创建，后面在该层级中创建的cgroup都是此cgroup的后代）的初始成员。
2.一个子系统最多只能附加到一个层级。
3.一个层级可以附加多个子系统
4.一个任务可以是多个cgroup的成员，但是这些cgroup必须在不同的层级。
5.系统中的进程（任务）创建子进程（任务）时，该子任务自动成为其父进程所在 cgroup 的成员。然后可根据需要将该子任务移动到不同的 cgroup 中，但开始时它总是继承其父任务的cgroup。

## 功能
1. 资源限制 Resource limiting
限制进程组可用的资源数量。
（例）memory子系统可以限定一个进程组的memoery上限，这也包括虚拟内存。
如果进程组达到限额后再申请内存，就会触发OOM。

2. 优先级 Prioritization
设置进程组的优先级。
（例）cpu子系统为某个进程组分配特定的cpu share.
一些组可以得到大量的CPU或磁盘IO吞吐量。

3. 结算 Accounting
记录进程组使用的资源数量。
（例）cpuacct子系统记录了进程组消耗的cpu时间片。
用来衡量系统确实把多少资源用在该进程组上。

4. 进程组隔离 isolation
解决进程组的访问冲突
（例）ns（namespace）子系统可以使不同的进程组使用不同的namespace，达到隔离的目的。
不同的进程组有各自的进程、网络、文件系统挂载空间。

5. 控制 Control
冻结组或检查点和重启动。
（例）freezer子系统可以将进程组挂起和恢复。

## 概念
