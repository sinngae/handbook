分布式事务
---

分布式异常情况
+ 某个服务的数据库宕机了
+ 某个服务自己挂了
+ 某个服务的Redis、ES、MQ等基础设施故障了
+ 某些资源不足了，比如库存不够

# TCC 分布式事务

Try-Confirm-Cancel
+ Try，多个资源做：状态变更中，直接更新改成冻结。
    + 如都冻结成功，则提交；否则回滚；
+ Confirm，不做检查，执行业务；
+ Cancel，释放被冻结的资源；


# XA 分布式事务

+ 
+ 


# 实际实践问题

## 最终一致性分布式事务如何保障实际生产的99.99%高可用？

## 异步调用，MQ如何做分布式事务？
MQ本身要支持 Try-Confirm-Cancel机制

如果不支持，只能把MQ作为最后一步（不可回滚的），且只能有一个。

通过状态管理 待确认-已发送-已完成，如果一直非已完成，则需要回溯处理。

